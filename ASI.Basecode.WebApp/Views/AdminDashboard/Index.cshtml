@using ASI.Basecode.Services.ServiceModels
@model AdminDashboardViewModel

@{
    Layout = "_AdminSidebarLayout";

    // Example data for demonstration
    var books = Enumerable.Range(1, 10).Select(i => new
    {
        Title = "The Lost Expedition",
        Author = "Tom Hardy, 2020",
        Image = Url.Content("~/img/bookcover_container.png"),
        Rating = 5
    }).ToList();

    int cardsPerSlide = 5;
    int totalSlides = 2;
    var newBooks = Model.NewBooks ?? new List<BookViewModel>();
    int newBooksTotalSlides = (int)Math.Ceiling(newBooks.Count / (double)cardsPerSlide);

    var topRatedBooks = Model.TopRatedBooks ?? new List<BookViewModel>();
    int topRatedBooksTotalSlides = (int)Math.Ceiling(topRatedBooks.Count / (double)cardsPerSlide);

    }
@section styles {
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="~/css/admin/common.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/admin/dashboard.css" asp-append-version="true" />
    <style>
        .stats-card {
            cursor: pointer;
        }
    </style>
}

<div class="admin-common-container">
    <div class="admin-common-content-wrapper">
        <div class="header-section">
            <h1>Dashboard</h1>
            <p>Overview of your book review platform</p>
        </div>

        <!-- Stats Cards -->
        <div class="row g-4 mb-4">
            <div class="col-md-6 col-lg-3">
                <div class="stats-card a" onclick="window.location.href='@Url.Action("Index", "Review")'">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3 class="mb-0">@Model.TotalReviews</h3>
                            <p class="text-muted mb-0">Total Reviews</p>
                        </div>
                        <i class="fas fa-star stats-icon"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="stats-card b" onclick="window.location.href='@Url.Action("ListBook", "Book")'">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3 class="mb-0">@Model.TotalBooks</h3>
                            <p class="text-muted mb-0">Total Books</p>
                        </div>
                        <i class="fas fa-book stats-icon"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="stats-card a" onclick="window.location.href='@Url.Action("Index", "User")'">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3 class="mb-0">@Model.TotalUsers</h3>
                            <p class="text-muted mb-0">Total Users</p>
                        </div>
                        <i class="fas fa-users stats-icon"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="stats-card b" onclick="window.location.href='@Url.Action("ListGenre", "BookGenre")'">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3 class="mb-0">@Model.TotalGenres</h3>
                            <p class="text-muted mb-0">Total Genres</p>
                        </div>
                        <i class="fas fa-tags stats-icon"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Newly Added Books Section -->
        <div class="section mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="section-title">Newly Added Books</h2>
                <a href="#" class="view-more">View more <i class="fas fa-arrow-right"></i></a>
            </div>
            <div class="carousel-container">
                <div id="newBooksCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
                    <div class="carousel-inner">
                        @for (int slide = 0; slide < totalSlides; slide++)
                        {
                            <div class="carousel-item @(slide == 0 ? "active" : "")">
                                <div class="row carousel-row justify-content-center">
                                    @for (int card = 0; card < cardsPerSlide; card++)
                                    {
                                        int bookIndex = slide * cardsPerSlide + card;
                                        if (bookIndex >= newBooks.Count) { break; }
                                        var book = newBooks[bookIndex];
                                        <div class="book-card-wrapper">
                                            <div class="book-card">
                                                <a href="/Book/BookDetails/@book.BookId">
                                                     <img src="@book.CoverImageUrl" class="book-cover" alt="Book cover">
                                                <div class="book-info">
                                                    <h5>@book.Title</h5>
                                                    <p class="author">@book.Author</p>
                                                    <div class="rating">
                                                        @for (int star = 0; star < book.AverageRating; star++)
                                                        {
                                                            <i class="fas fa-star"></i>
                                                        }
                                                    </div>
                                                </div>
                                                    </a>
                                               
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#newBooksCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#newBooksCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Top 10 Rated Books Section -->
        <div class="section">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="section-title">Top 10 Rated Books</h2>
                <a href="#" class="view-more">View more <i class="fas fa-arrow-right"></i></a>
            </div>
            <div class="carousel-container">
                <div id="topBooksCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
                    <div class="carousel-inner">
                        @for (int slide = 0; slide < totalSlides; slide++)
                        {
                            <div class="carousel-item @(slide == 0 ? "active" : "")">
                                <div class="row carousel-row justify-content-center">
                                    @for (int card = 0; card < cardsPerSlide; card++)
                                    {
                                        int bookIndex = slide * cardsPerSlide + card;
                                        if (bookIndex >= topRatedBooks.Count) { break; }
                                        var book = topRatedBooks[bookIndex];
                                        <div class="book-card-wrapper">
                                            <div class="book-card">
                                                <a href="/Book/BookDetails/@book.BookId">
                                                    <img src="@book.CoverImageUrl" class="book-cover" alt="Book cover">
                                                <div class="book-info">
                                                    <h5>@book.Title</h5>
                                                    <p class="author">@book.Author</p>
                                                    <div class="rating">
                                                        @for (int star = 0; star < book.AverageRating; star++)
                                                        {
                                                            <i class="fas fa-star"></i>
                                                        }
                                                    </div>
                                                </div>
                                                    </a>
                                               
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#topBooksCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#topBooksCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
}
